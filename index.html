<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinoy Food Personality Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #F48C06;
            --accent: #D00000;
            --bg: #FFF8E1;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text: #370617;
            --sub-text: #6a4c93;
            --btn-text: #fff;
            --shadow: rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --primary: #FFBA08;
            --accent: #FF6B6B;
            --bg: #1a1a1a;
            --card-bg: rgba(40, 40, 40, 0.95);
            --text: #f0f0f0;
            --sub-text: #b0b0b0;
            --btn-text: #1a1a1a;
            --shadow: rgba(0,0,0,0.5);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(var(--primary) 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
            transition: background 0.3s, color 0.3s;
        }

        .top-bar {
            width: 100%; max-width: 500px; display: flex; justify-content: space-between; margin-bottom: 20px;
        }
        .icon-btn {
            background: var(--card-bg); border: 2px solid var(--primary); color: var(--text);
            padding: 8px 15px; border-radius: 20px; cursor: pointer; font-weight: 600; transition: all 0.2s;
        }
        .icon-btn:hover { background: var(--primary); color: var(--btn-text); }

        .container {
            width: 100%; max-width: 500px; text-align: center; position: relative;
            background: var(--card-bg); padding: 30px 20px; border-radius: 25px;
            box-shadow: 0 10px 30px var(--shadow); backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .screen { display: none; }
        .screen.active { display: block; animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .title { font-size: 2rem; font-weight: 900; color: var(--accent); margin: 0 0 10px 0; line-height: 1.1; }
        .subtitle { font-size: 1rem; color: var(--sub-text); margin-bottom: 30px; }
        
        .btn {
            background-color: var(--primary); color: var(--btn-text); border: none; padding: 15px;
            font-size: 1rem; font-weight: 600; border-radius: 15px; cursor: pointer; width: 100%;
            transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 0 rgba(0,0,0,0.2);
            margin-bottom: 10px; min-height: 60px; display: flex; align-items: center; justify-content: center;
        }
        .btn:active { transform: translateY(4px); box-shadow: none; }
        .btn-start { font-size: 1.3rem; padding: 20px; border-radius: 50px; background-color: var(--accent); color: white; }

        /* Î≤ÑÌäº ÏÉâÏÉÅ */
        #opt-0 { background-color: #2e7d32; color: white; }
        #opt-1 { background-color: #81c784; color: #1a1a1a; }
        #opt-2 { background-color: #ffb74d; color: #1a1a1a; }
        #opt-3 { background-color: #c62828; color: white; }
        #opt-0:hover, #opt-1:hover, #opt-2:hover, #opt-3:hover { filter: brightness(1.1); }

        .loader-container { margin: 40px 0; }
        .percentage { font-size: 3.5rem; font-weight: 900; color: var(--primary); font-variant-numeric: tabular-nums; }
        .loader-bar { width: 100%; height: 10px; background: #ddd; border-radius: 5px; overflow: hidden; margin-top: 10px; }
        .loader-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.1s; }
        
        .mbti-badge { 
            background: var(--text); color: var(--bg); padding: 5px 15px; border-radius: 20px; 
            font-weight: bold; display: inline-block; margin-bottom: 10px; letter-spacing: 2px;
        }
        
        .food-name { 
            font-size: 3.2rem; font-weight: 900; color: var(--accent); 
            margin: 5px 0 25px 0; line-height: 1.1; 
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }
        
        .info-box {
            background: rgba(0,0,0,0.03); border-left: 5px solid var(--primary);
            padding: 20px; text-align: left; border-radius: 10px; margin-bottom: 15px;
        }
        .info-title { font-weight: 900; color: var(--text); display: flex; align-items: center; gap: 5px; margin-bottom: 8px; font-size: 1.1rem; }
        .info-content { font-size: 0.95rem; color: var(--text); line-height: 1.7; text-align: justify; }

        .k-star-box { border-color: #d63384; background: rgba(214, 51, 132, 0.05); }
        .mission-box { border-color: #20c997; background: rgba(32, 201, 151, 0.05); }

        .progress-container { width: 100%; background: rgba(0,0,0,0.1); height: 8px; border-radius: 4px; margin-bottom: 20px; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; border-radius: 4px; }
    </style>
</head>
<body data-theme="light">

    <div class="top-bar">
        <button class="icon-btn" onclick="toggleLang()" id="lang-btn">üá∫üá∏ Eng</button>
        <button class="icon-btn" onclick="toggleTheme()" id="theme-btn">üåô Dark</button>
    </div>

    <div class="container">
        <div id="start-screen" class="screen active">
            <h1 class="title">Pinoy Food<br>Personality Test üáµüá≠</h1>
            <p class="subtitle" id="subtitle-text">Discover your soul food & K-Pop twin!</p>
            <div style="font-size: 5rem; margin-bottom: 20px;">üçõ</div>
            <button class="btn btn-start" onclick="startQuiz()" id="start-btn">Let's Eat! (Start)</button>
        </div>

        <div id="quiz-screen" class="screen">
            <div class="progress-container"><div class="progress-bar" id="progress"></div></div>
            <div style="text-align: right; font-size: 0.8rem; margin-bottom: 10px; font-weight: bold; color: var(--sub-text);" id="q-counter">Q1 / 16</div>
            <h2 id="question-text" style="margin-bottom: 30px; min-height: 80px; font-size: 1.3rem;">Question?</h2>
            
            <div id="options-container">
                <button class="btn" onclick="nextQuestion(3)" id="opt-0">Super Agree! üòç</button>
                <button class="btn" onclick="nextQuestion(1)" id="opt-1">Agree üôÇ</button>
                <button class="btn" onclick="nextQuestion(-1)" id="opt-2">Disagree üòï</button>
                <button class="btn" onclick="nextQuestion(-3)" id="opt-3">Super Disagree! üôÖ‚Äç‚ôÇÔ∏è</button>
            </div>
        </div>

        <div id="loading-screen" class="screen">
            <h2 id="analyzing-text">Analyzing your taste...</h2>
            <div class="loader-container">
                <div class="percentage" id="percentage">0%</div>
                <div class="loader-bar"><div class="loader-fill" id="loader-fill"></div></div>
            </div>
            <p id="loading-sub">Comparing with K-Pop Stars...</p>
        </div>

        <div id="result-screen" class="screen">
            <div class="mbti-badge" id="mbti-result">ESTJ</div>
            <div style="font-size: 1rem; font-weight: bold; color: var(--sub-text);" id="result-label">YOUR SOUL FOOD</div>
            <h1 class="food-name" id="food-name">Lechon üëë</h1>
            
            <div class="info-box">
                <div class="info-content" id="food-desc">Description here...</div>
            </div>

            <div class="info-box k-star-box">
                <div class="info-title">üé§ K-Pop / K-Drama Twin</div>
                <div class="info-content" id="k-match">Match Name</div>
            </div>

            <div class="info-box mission-box">
                <div class="info-title">üìÖ Today's Mission</div>
                <div class="info-content" id="mission-text">Mission here</div>
            </div>
            
            <button class="btn" onclick="shareResult()" style="background-color: var(--text); color: var(--bg);" id="share-btn">Share Result üì§</button>
            <button class="btn" onclick="location.reload()" style="background-color: transparent; border: 2px solid var(--text); color: var(--text);" id="retry-btn">Try Again üîÑ</button>
        </div>
    </div>

    <audio id="audio-click" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>
    <audio id="audio-result-e" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>
    <audio id="audio-result-i" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>

    <script>
        let curLang = 'en'; 
        let curTheme = 'light';

        const uiText = {
            en: {
                subtitle: "Discover your soul food & K-Pop twin!", startBtn: "Let's Eat! (Start)",
                analyzing: "Analyzing your personality...", loadingSub: "Finding your K-Pop soulmate...",
                resultLabel: "YOUR SOUL FOOD IS", shareBtn: "Share Result üì§", retryBtn: "Try Again üîÑ",
                options: ["Super Agree! üòç", "Agree üôÇ", "Disagree üòï", "Super Disagree! üôÖ‚Äç‚ôÇÔ∏è"]
            },
            tl: {
                subtitle: "Alamin ang iyong Soul Food at K-Pop Twin!", startBtn: "Tara Kain! (Simula)",
                analyzing: "Ina-analyze ang iyong personality...", loadingSub: "Hinahanap ang iyong K-Pop match...",
                resultLabel: "ANG SOUL FOOD MO AY", shareBtn: "I-share ang Resulta üì§", retryBtn: "Ulitin ang Quiz üîÑ",
                options: ["Sobrang Agree! üòç", "Pwede üôÇ", "Di masyado üòï", "Sobrang Hindi! üôÖ‚Äç‚ôÇÔ∏è"]
            }
        };

        const questionBank = {
            EI: [
                { en: "I feel energized when I'm at a party with many people.", tl: "Ganado ako pag nasa party na maraming tao.", invert: false, type: "EI" },
                { en: "I usually start conversations first.", tl: "Ako madalas ang nauunang makipag-usap.", invert: false, type: "EI" },
                { en: "I enjoy being alone more than going out.", tl: "Mas gusto kong mapag-isa kaysa lumabas.", invert: true, type: "EI" },
                { en: "I prefer a small group of friends over a big crowd.", tl: "Mas gusto ko ang onting tropa kesa sa malaking barkada.", invert: true, type: "EI" },
                { en: "I am often the center of attention in a group.", tl: "Madalas akong sentro ng atensyon sa grupo.", invert: false, type: "EI" },
                { en: "I think before I speak.", tl: "Nag-iisip muna ako bago magsalita.", invert: true, type: "EI" },
                { en: "I get lonely easily if I don't meet people.", tl: "Madali akong malungkot pag walang kausap.", invert: false, type: "EI" },
                { en: "I need time alone to recharge after work.", tl: "Kailangan ko mapag-isa para mag-recharge.", invert: true, type: "EI" }
            ],
            SN: [
                { en: "I trust facts and experience more than theories.", tl: "Mas naniniwala ako sa experience kaysa sa theories.", invert: false, type: "SN" },
                { en: "I focus on the present rather than the future.", tl: "Mas focus ako sa ngayon kaysa sa future.", invert: false, type: "SN" },
                { en: "I often daydream and imagine 'what if'.", tl: "Madalas akong managinip ng gising (daydream).", invert: true, type: "SN" },
                { en: "I love discussing abstract ideas and meanings.", tl: "Mahilig ako sa mga malalim na usapan at ideas.", invert: true, type: "SN" },
                { en: "I prefer clear instructions over improvisation.", tl: "Gusto ko ng malinaw na utos kaysa manghula.", invert: false, type: "SN" },
                { en: "I look for hidden meanings in things.", tl: "Naghahanap ako ng hidden meaning sa mga bagay.", invert: true, type: "SN" },
                { en: "I am very practical and realistic.", tl: "Praktikal ako at makatotohanan.", invert: false, type: "SN" },
                { en: "I have a vivid imagination.", tl: "Malawak ang imahinasyon ko.", invert: true, type: "SN" }
            ],
            TF: [
                { en: "I follow logic more than my heart.", tl: "Mas sinusunod ko ang utak ko kaysa puso.", invert: false, type: "TF" },
                { en: "Being honest is more important than not hurting feelings.", tl: "Mas okay nang prangka kaysa maging plastic.", invert: false, type: "TF" },
                { en: "I make decisions based on emotions.", tl: "Nagde-decide ako base sa nararamdaman ko.", invert: true, type: "TF" },
                { en: "I prioritize harmony over being right.", tl: "Mas mahalaga sakin na walang away kaysa ako ang tama.", invert: true, type: "TF" },
                { en: "I am often described as 'cold' or 'rational'.", tl: "Sabi nila 'cold' daw ako o masyadong lohikal.", invert: false, type: "TF" },
                { en: "I easily empathize with other people's problems.", tl: "Madali akong maawa sa problema ng iba.", invert: true, type: "TF" },
                { en: "Efficiency is more important than cooperation.", tl: "Mas mahalaga ang bilis kaysa samahan.", invert: false, type: "TF" },
                { en: "I try not to hurt anyone's feelings.", tl: "Iniiwasan kong makasakit ng damdamin.", invert: true, type: "TF" }
            ],
            JP: [
                { en: "I like to have a detailed plan before traveling.", tl: "Gusto ko may itinerary bago bumyahe.", invert: false, type: "JP" },
                { en: "I finish work way before the deadline.", tl: "Tinatappos ko ang trabaho nang maaga sa deadline.", invert: false, type: "JP" },
                { en: "I am spontaneous and flexible.", tl: "Biglaan ang mga lakad ko at flexible ako.", invert: true, type: "JP" },
                { en: "I work better under pressure at the last minute.", tl: "Mas magaling ako gumawa pag cramming.", invert: true, type: "JP" },
                { en: "I like to keep my room and desk organized.", tl: "Gusto ko laging maayos ang gamit ko.", invert: false, type: "JP" },
                { en: "I often change my plans at the last moment.", tl: "Madalas akong magbago ng isip last minute.", invert: true, type: "JP" },
                { en: "I make to-do lists for everything.", tl: "Gumagawa ako ng to-do list para sa lahat.", invert: false, type: "JP" },
                { en: "Rules and schedules are meant to be broken.", tl: "Ang rules at schedule ay pwedeng baliin.", invert: true, type: "JP" }
            ]
        };

        const resultsData = {
            "INTJ": { 
                food: "Kapeng Barako", emoji: "‚òï",
                enDesc: "Just like pure Kapeng Barako, you are bold, intense, and strong. You are not for everyone, and you don't try to be. You value efficiency and intellect over popularity. You wake people up with your hard truths and deep insights. While you may seem cold on the outside, you are extremely reliable and of premium quality.", 
                tlDesc: "Parang Kapeng Barako, matapang ka at seryoso. Hindi ka para sa lahat, at okay lang yun sayo. Mas gusto mo ang quality at talino kaysa maging sikat. Ginugulat mo ang mga tao sa talas ng isip mo. Mukha kang masungit minsan, pero ikaw ang pinaka-reliable at 'premium' na tao sa barkada.", 
                kstar: "G-Dragon (BigBang), Kageyama (Haikyuu)", enAct: "Plan your next 5-year goal today.", tlAct: "Planuhin mo na ang goals mo for next 5 years." 
            },
            "INTP": { 
                food: "Balut", emoji: "ü•ö",
                enDesc: "You are unique, complex, and full of surprises, just like Balut. Many people might misunderstand you at first glance, but those who are brave enough to get to know you find a hidden gem. You live in your own world of theories and ideas. You are unconventional and always thinking outside the box.", 
                tlDesc: "Kakaiba ka at puno ng surpresa, parang Balut. Maraming hindi ka agad naiintindihan sa unang tingin, pero ang mga tunay na nakakakilala sayo ay alam na special ka. May sarili kang mundo. Hindi ka sumusunod sa uso, at lagi kang may kakaibang ideas na ikaw lang ang nakakaisip.", 
                kstar: "Jin (BTS), Kenma (Haikyuu)", enAct: "Watch a documentary or learn a weird fact.", tlAct: "Manood ng documentary o mag-research ng weird facts." 
            },
            "ENTJ": { 
                food: "Lechon", emoji: "üëë",
                enDesc: "You are the Lechon: the star of the feast and the center of attention. You are a natural-born leader who demands respect. You are ambitious, confident, and high-value. A party isn't complete without you, but you can be high-maintenance. You know what you want, and you know exactly how to get it.", 
                tlDesc: "Ikaw ang Lechon: ang bida sa handaan at center of attention. Pinanganak kang leader at nirerespeto ng lahat. Mataas ang pangarap mo at confident ka. Hindi kumpleto ang party pag wala ka. Alam mo ang gusto mo, at gagawin mo ang lahat para makuha yun.", 
                kstar: "Ko Moon-young (It's Okay to Not Be Okay)", enAct: "Start a new project or lead a group chat.", tlAct: "Mag-umpisa ng bagong project o ikaw mag-aya sa GC." 
            },
            "ENTP": { 
                food: "Sisig", emoji: "üå∂Ô∏è",
                enDesc: "Sizzling, spicy, and exciting! Like Sisig, you love mixing things up. You hate boredom and love a good debate. You are adaptable and can fit in anywhere, from street food stalls to fancy dinners. You bring the 'spice' to life and are always ready for a new adventure or argument.", 
                tlDesc: "Mainit, maanghang, at exciting! Parang Sisig, ayaw mo ng boring. Mahilig ka sa debate at thrill. Bagay ka kahit saan, mapakalsada man o hotel. Ikaw ang nagbibigay ng anghang at saya sa barkada. Laging handa sa adventure o diskusyon.", 
                kstar: "Jay Park, Ryuk (Death Note)", enAct: "Debate with a friend about something random.", tlAct: "Makipag-debate sa tropa tungkol sa kahit ano." 
            },
            "INFJ": { 
                food: "Kare-Kare", emoji: "ü•ú",
                enDesc: "You are Kare-Kare: rich, complex, and deep. You are not a simple dish; you have layers of flavor. You are quiet but have a very rich inner world. You need your 'bagoong' (close friends) to truly feel complete. You are rare and special, and people appreciate your depth once they understand you.", 
                tlDesc: "Ikaw ay Kare-Kare: mayaman sa lasa at malalim. Hindi ka simple; marami kang layers. Tahimik ka lang pero sobrang lalim ng iniisip mo. Kailangan mo ng 'bagoong' (tunay na kaibigan) para kumpleto ang araw mo. Special ka at rare, kaya swerte ang nakakakilala sayo.", 
                kstar: "IU, Elsa (Frozen)", enAct: "Write in your journal or meditate.", tlAct: "Magsulat sa diary o mag-meditate." 
            },
            "INFP": { 
                food: "Champorado", emoji: "üç´",
                enDesc: "Sweet, warm, and comforting. Like Champorado on a rainy day, you heal people's souls. You are a dreamer with a soft heart. You value authenticity and feelings. You might be a bit slow to open up, but you are incredibly sweet once you trust someone. You live in your own cozy world.", 
                tlDesc: "Matamis at mainit. Parang Champorado sa tag-ulan, ikaw ang comfort food ng lahat. Dreamer ka at malambot ang puso. Mahalaga sayo ang totoong nararamdaman. Medyo mahiyain ka sa una, pero sobrang tamis mo magmahal. May sarili kang cozy na mundo.", 
                kstar: "V (BTS), Jennie (Blackpink)", enAct: "Listen to sad songs and look at the sky.", tlAct: "Makinig sa sad songs habang nakatingin sa langit." 
            },
            "ENFJ": { 
                food: "Taho", emoji: "ü•§",
                enDesc: "You are Taho: the sweet start to everyone's day. You are encouraging, warm, and loved by all. You are soft (like tofu) but sweet (like arnibal). You genuinely care about people and want everyone to be happy. You are the cheerleader of your group, always shouting 'Good Morning!' to the world.", 
                tlDesc: "Ikaw ang Taho: ang matamis na simula ng araw. Encouraging ka, warm, at love ng lahat. Malambot ang puso mo (tofu) pero sweet (arnibal). Gusto mo laging masaya ang iba. Ikaw ang cheerleader ng barkada na laging bumabati ng 'Good Morning!'", 
                kstar: "Jimin (BTS), Tanjiro (Demon Slayer)", enAct: "Send a compliment to 3 friends.", tlAct: "Mag-send ng compliment sa 3 friends." 
            },
            "ENFP": { 
                food: "Halo-Halo", emoji: "üåà",
                enDesc: "You are the ultimate mix! Colorful, chaotic, and sweet like Halo-Halo. You are the life of the party and full of endless possibilities. You can't be defined by just one ingredient. You are creative, free-spirited, and bring energy wherever you go. Life is never boring with you around.", 
                tlDesc: "Ikaw ang ultimate mix! Makulay, magulo, at matamis parang Halo-Halo. Ikaw ang bumubuhay sa party. Hindi ka pwedeng ikahon sa iisang bagay lang. Creative ka at malaya. Hinding-hindi magiging boring ang buhay kapag kasama ka.", 
                kstar: "Sana (Twice), Spider-Man", enAct: "Try a new hobby or go somewhere new.", tlAct: "Subukan ang bagong hobby o pumunta sa bagong lugar." 
            },
            "ISTJ": { 
                food: "Adobo", emoji: "ü•ò",
                enDesc: "You are Adobo: the timeless classic. You are reliable, consistent, and practical. Trends may come and go, but you stay strong. You value tradition and rules. You are the pillar of your family and friends. You might not be the flashiest, but you are the one that lasts the longest.", 
                tlDesc: "Ikaw ang Adobo: ang classic na hindi nalalaos. Maasahan ka at consistent. Maraming uso ang dumadaan, pero ikaw matatag pa rin. Respetado mo ang rules at tradition. Ikaw ang pundasyon ng pamilya. Hindi ka man papampam, pero ikaw ang pinaka-tumatagal.", 
                kstar: "Irene (Red Velvet), Captain America", enAct: "Organize your room or workspace.", tlAct: "Ligpitin ang kwarto o workspace." 
            },
            "ISFJ": { 
                food: "Sinigang", emoji: "üç≤",
                enDesc: "A warm hug in a bowl. You are Sinigang: comforting and essential. You are very empathetic and sense when people are sad. You might be a bit 'sour' (honest/strict) sometimes, but it comes from a place of care. You are the healer of the group who takes care of everyone.", 
                tlDesc: "Isang mainit na yakap. Ikaw ang Sinigang: comforting at kailangan ng lahat. Ramdam mo agad pag malungkot ang iba. Minsan 'maasim' ka (masungit), pero dahil lang yun sa pagmamalasakit. Ikaw ang taga-alaga at healer ng barkada.", 
                kstar: "Dahyun (Twice), Cinderella", enAct: "Cook something nice for your family.", tlAct: "Ipagluto ng masarap ang pamilya." 
            },
            "ESTJ": { 
                food: "Pancit Canton", emoji: "üçú",
                enDesc: "Symbol of long life and order. Like Pancit at a birthday, you are essential for gatherings. You are organized, efficient, and take charge of situations. You make sure everything runs smoothly. You are hardworking and traditional, ensuring that no one is left behind.", 
                tlDesc: "Simbolo ng long life at kaayusan. Parang Pancit sa birthday, kailangan ka sa handaan. Organisado ka at magaling mag-manage. Sinisigurado mong maayos ang takbo ng lahat. Masipag ka at tradisyunal, ikaw ang bahala sa lahat.", 
                kstar: "BamBam (GOT7), Hermione Granger", enAct: "Make a To-Do list and finish it all.", tlAct: "Gumawa ng To-Do list at tapusin lahat." 
            },
            "ESFJ": { 
                food: "Lumpia", emoji: "üåØ",
                enDesc: "Everyone's favorite! You are Lumpia: you fit in at every occasion, from simple dinners to grand fiestas. You are social, friendly, and popular. People literally fight over you because you are so nice. You go to great lengths to make others feel welcome and happy.", 
                tlDesc: "Favorite ng lahat! Ikaw ang Lumpia: bagay ka sa lahat ng okasyon, simple man o fiesta. Friendly ka at sikat. Pinag-aagawan ka ng mga tao kasi sobrang bait mo. Ginagawa mo ang lahat para maging komportable at masaya ang mga kasama mo.", 
                kstar: "J-Hope (BTS), SpongeBob", enAct: "Call a friend you haven't seen in a while.", tlAct: "Tawagan ang friend na matagal mo nang di nakikita." 
            },
            "ISTP": { 
                food: "Kinilaw", emoji: "üêü",
                enDesc: "Fresh, raw, and cool. Like Kinilaw, you don't need heat (drama) to be great. You are practical, realistic, and skilled. You adapt to situations quickly and solve problems with cool logic. You are straightforward and prefer action over long words.", 
                tlDesc: "Fresh at cool. Parang Kinilaw, di mo kailangan ng apoy (drama) para maging astig. Praktikal ka at madiskarte. Mabilis kang mag-adjust sa sitwasyon at magaling lumutas ng problema. Diretso ka kung kumilos at ayaw mo ng paligoy-ligoy.", 
                kstar: "Suga (BTS), Hawkeye", enAct: "Fix something broken or do sports.", tlAct: "Mag-ayos ng sirang gamit o mag-exercise." 
            },
            "ISFP": { 
                food: "Buko Pie", emoji: "ü••",
                enDesc: "You are Buko Pie: hard on the outside (crust) but soft and sweet on the inside. You are artistic and aesthetic. You don't show your feelings easily to strangers, but you are deeply caring to those you love. You have a unique style and appreciate the simple beauties of life.", 
                tlDesc: "Ikaw ang Buko Pie: matigas sa labas (crust) pero malambot at matamis sa loob. Artistic ka. Hindi mo agad pinapakita ang feelings mo sa iba, pero sobrang bait mo sa mga mahal mo. May sarili kang style at na-aappreciate mo ang ganda ng buhay.", 
                kstar: "Jungkook (BTS), Harry Potter", enAct: "Draw, paint, or take aesthetic photos.", tlAct: "Mag-drawing o kumuha ng aesthetic na photos." 
            },
            "ESTP": { 
                food: "Isaw", emoji: "üç¢",
                enDesc: "Street-smart and risky. You are Isaw: addictive and everywhere! You love taking risks and living on the edge. You are action-oriented and hate sitting still. You are the life of the street party, always ready for the next spontaneous adventure.", 
                tlDesc: "Madiskarte at matapang. Ikaw ang Isaw: nakaka-addict at laging present! Mahilig ka sa risk at adventure. Ayaw mong nakatengga lang. Ikaw ang bida sa kalye, laging handa sa biglaang gala at saya.", 
                kstar: "Jimin (BTS), Thor", enAct: "Go on a spontaneous trip or adventure.", tlAct: "Mag-roadtrip o gumala nang biglaan." 
            },
            "ESFP": { 
                food: "Crispy Pata", emoji: "üçñ",
                enDesc: "Loud, crunchy, and sinful! You are Crispy Pata: the ultimate treat. You love being the center of attention and entertaining others. You live for the moment and want to enjoy life to the fullest. You are generous, fun, and make everyone smile.", 
                tlDesc: "Maingay, crunchy, at masarap! Ikaw ang Crispy Pata: ang ultimate treat. Gusto mong nag-eentertain ng tao. Ini-enjoy mo ang bawat moment ng buhay. Galante ka, masaya kasama, at napapangiti mo ang lahat.", 
                kstar: "Rain, Luffy (One Piece)", enAct: "Dance to your favorite song.", tlAct: "Sumayaw sa favorite mong kanta." 
            }
        };

        let scores = { E:0, I:0, S:0, N:0, T:0, F:0, J:0, P:0 };
        let qIndex = 0;
        let activeQuestions = [];
        
        // ‚ú® Audio Objects ‚ú®
        const clickSound = document.getElementById('audio-click');
        const resultSoundE = document.getElementById('audio-result-e'); // Fanfare
        const resultSoundI = document.getElementById('audio-result-i'); // Magic Chime

        function playClick() {
            clickSound.currentTime = 0;
            clickSound.play().catch(e => console.log("Audio play blocked by browser"));
        }

        function playResult(type) {
            // E ÌÉÄÏûÖÏù¥Î©¥ Ìå°ÌååÎ†à, I ÌÉÄÏûÖÏù¥Î©¥ Îß§ÏßÅ ÏÇ¨Ïö¥Îìú
            if (type.includes('E')) {
                resultSoundE.currentTime = 0;
                resultSoundE.play().catch(e => console.log("Audio play blocked"));
            } else {
                resultSoundI.currentTime = 0;
                resultSoundI.play().catch(e => console.log("Audio play blocked"));
            }
        }

        function toggleLang() {
            playClick();
            curLang = (curLang === 'en') ? 'tl' : 'en';
            document.getElementById('lang-btn').innerText = (curLang === 'en') ? 'üá∫üá∏ Eng' : 'üáµüá≠ Tagalog';
            updateUIText();
        }

        function toggleTheme() {
            playClick();
            curTheme = (curTheme === 'light') ? 'dark' : 'light';
            document.body.setAttribute('data-theme', curTheme);
            document.getElementById('theme-btn').innerText = (curTheme === 'light') ? 'üåô Dark' : '‚òÄÔ∏è Light';
        }

        function updateUIText() {
            const t = uiText[curLang];
            document.getElementById('subtitle-text').innerText = t.subtitle;
            document.getElementById('start-btn').innerText = t.startBtn;
            document.getElementById('analyzing-text').innerText = t.analyzing;
            document.getElementById('loading-sub').innerText = t.loadingSub;
            document.getElementById('result-label').innerText = t.resultLabel;
            document.getElementById('share-btn').innerText = t.shareBtn;
            document.getElementById('retry-btn').innerText = t.retryBtn;
            
            if(document.getElementById('quiz-screen').style.display === 'block') {
                 showQuestion(false);
            }
        }

        function startQuiz() {
            playClick();
            scores = { E:0, I:0, S:0, N:0, T:0, F:0, J:0, P:0 };
            qIndex = 0;
            activeQuestions = [];

            // Randomly select 4 questions from each type
            ['EI', 'SN', 'TF', 'JP'].forEach(type => {
                const shuffled = [...questionBank[type]].sort(() => Math.random() - 0.5);
                activeQuestions.push(...shuffled.slice(0, 4));
            });

            activeQuestions.sort(() => Math.random() - 0.5);

            document.getElementById('start-screen').classList.remove('active');
            document.getElementById('result-screen').classList.remove('active');
            document.getElementById('quiz-screen').classList.add('active');
            showQuestion(true);
        }

        function showQuestion(resetOptions = true) {
            let q = activeQuestions[qIndex];
            document.getElementById('q-counter').innerText = `Q${qIndex + 1} / 16`;
            document.getElementById('question-text').innerText = (curLang === 'en') ? q.en : q.tl;
            
            const opts = uiText[curLang].options;
            for(let i=0; i<4; i++) {
                document.getElementById(`opt-${i}`).innerText = opts[i];
            }
            
            let percent = (qIndex / 16) * 100;
            document.getElementById('progress').style.width = percent + "%";
        }

        function nextQuestion(point) {
            playClick(); // ‚ú® ÌÅ¥Î¶≠ ÏÜåÎ¶¨ Ïû¨ÏÉù
            let q = activeQuestions[qIndex];
            let type = q.type; 
            let typeChars = type.split('');
            
            let finalPoint = q.invert ? -point : point;

            if (finalPoint > 0) scores[typeChars[0]] += Math.abs(finalPoint);
            else scores[typeChars[1]] += Math.abs(finalPoint);

            qIndex++;
            if (qIndex < 16) showQuestion();
            else showLoading();
        }

        function showLoading() {
            document.getElementById('quiz-screen').classList.remove('active');
            document.getElementById('loading-screen').classList.add('active');
            
            let percent = 0;
            const percentEl = document.getElementById('percentage');
            const fillEl = document.getElementById('loader-fill');
            
            const interval = setInterval(() => {
                percent++;
                percentEl.innerText = percent + "%";
                fillEl.style.width = percent + "%";
                
                if (percent >= 100) {
                    clearInterval(interval);
                    setTimeout(calculateResult, 500);
                }
            }, 30);
        }

        function calculateResult() {
            document.getElementById('loading-screen').classList.remove('active');
            document.getElementById('result-screen').classList.add('active');

            let mbti = "";
            mbti += (scores.E >= scores.I) ? "E" : "I";
            mbti += (scores.S >= scores.N) ? "S" : "N";
            mbti += (scores.T >= scores.F) ? "T" : "F";
            mbti += (scores.J >= scores.P) ? "J" : "P";
            
            // ‚ú® Í≤∞Í≥º ÏÜåÎ¶¨ Ïû¨ÏÉù (EÎäî Ìå°ÌååÎ†à, IÎäî Îß§ÏßÅÏÇ¨Ïö¥Îìú)
            playResult(mbti);

            const r = resultsData[mbti];
            
            document.getElementById('mbti-result').innerText = mbti;
            document.getElementById('food-name').innerText = `${r.food} ${r.emoji}`;
            
            if (curLang === 'en') {
                document.getElementById('food-desc').innerText = r.enDesc;
                document.getElementById('mission-text').innerText = r.enAct;
            } else {
                document.getElementById('food-desc').innerText = r.tlDesc;
                document.getElementById('mission-text').innerText = r.tlAct;
            }
            
            document.getElementById('k-match').innerText = r.kstar;
        }

        function shareResult() {
             playClick();
             const dummyUrl = window.location.href; 
             navigator.clipboard.writeText(dummyUrl).then(() => {
                 alert((curLang === 'en') ? "Link copied!" : "Na-copy na ang link!");
             });
        }
    </script>
</body>
</html>
